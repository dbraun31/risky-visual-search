summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier than Reference` = 'grey', `Harder than Reference` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank())
d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced')) %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank())
d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced')) %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.25, .9))
d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced')) %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced')) %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print()
d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced')) %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
d <- d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'),
timing = recode(timing, `Controlled` = 'Enforced', `Uncontrolled` = 'Not Enforced'))
d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
d %>%
group_by(subject, direction, timing) %>%
summarize(ssd = mean(ssd)) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~timing) +
ylim(0,1) +
labs(
x = 'Direction',
y = 'Proportion Selection of Safe Option'
) +
theme_bw()
p1 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
p1
m <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_))
p2 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd = mean(ssd)) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~timing) +
ylim(0,1) +
labs(
x = 'Direction',
y = 'Proportion Selection of Safe Option'
) +
theme_bw()
p2
m <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_))
p2 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd = mean(ssd)) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~timing) +
ylim(0,1) +
labs(
x = 'Framing',
y = 'Proportion Selection of Safe Option'
) +
theme_bw() +
theme(strip.background = element_rect(color = 'black', fill = 'white'),
axis.ticks = element_blank(),
panel.grid = element_blank())
p2
p2 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd = mean(ssd)) %>%
mutate(timing = recode(timing, `Enforced` = 'Delay Enforced',
`Not Enforced` = 'Delay not Enforced')) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~timing) +
ylim(0,1) +
labs(
x = 'Framing',
y = 'Proportion Selection of Safe Option'
) +
theme_bw() +
theme(strip.background = element_rect(color = 'black', fill = 'white'),
axis.ticks = element_blank(),
panel.grid = element_blank())
p2
p1 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
p1
q()
library(tidyverse)
library(ggsci)
d <- read.csv('../../../data/main_timing.csv')
N <- length(unique(d$subject))
head(d)
d <- d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'))
p1 <- d %>%
group_by(subject, direction, timing) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, timing) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = timing, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
p1 <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, delay) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = delay, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
p1
m <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, delay) %>%
summarize(ssd = mean(ssd_))
p2 <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd = mean(ssd)) %>%
mutate(delay = recode(delay, `Enforced` = 'Delay Enforced',
`Not Enforced` = 'Delay not Enforced')) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~delay) +
ylim(0,1) +
labs(
x = 'Framing',
y = 'Proportion Selection of Safe Option'
) +
theme_bw() +
theme(strip.background = element_rect(color = 'black', fill = 'white'),
axis.ticks = element_blank(),
panel.grid = element_blank())
p2
library(gridExtra)
grid.arrange(p1, p2, nrow = 2)
grid.arrange(p1, p2, nrow = 1)
library(tidyverse)
library(ggsci)
library(gridExtra)
d <- read.csv('../../../data/main_delay.csv')
library(tidyverse)
library(ggsci)
library(gridExtra)
d <- read.csv('../../../data/main_timing.csv')
N <- length(unique(d$subject))
head(d)
d <- d %>%
mutate(direction = recode(direction, `Easier than Reference` = 'Easier',
`Harder than Reference` = 'Harder'))
p1 <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, delay) %>%
summarize(ssd = mean(ssd_), se = sd(ssd_) / sqrt(N)) %>%
print() %>%
ggplot(aes(x = delay, y = ssd)) +
geom_hline(yintercept = .5, linetype = 'dotted') +
geom_bar(stat = 'identity', aes(fill = direction), position = position_dodge(width= .9), color = 'black') +
geom_errorbar(aes(ymin = ssd - se, ymax = ssd + se, group = direction), width = .5, position = position_dodge(width= .9)) +
ylim(0,1) +
labs(
x = 'Delay',
y = 'Proportion Selection of Safe Deck',
fill = 'Framing',
caption = paste0('N = ', N, '.')
) +
scale_fill_manual(values = c(`Easier` = 'grey', `Harder` = 'white')) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.position = c(.2, .85))
p1
m <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd_ = mean(ssd)) %>%
group_by(direction, delay) %>%
summarize(ssd = mean(ssd_))
p2 <- d %>%
group_by(subject, direction, delay) %>%
summarize(ssd = mean(ssd)) %>%
mutate(delay = recode(delay, `Enforced` = 'Delay Enforced',
`Not Enforced` = 'Delay not Enforced')) %>%
ggplot(aes(x = direction, y = ssd)) +
geom_violin(fill = 'steelblue', alpha = .2) +
geom_boxplot(fill = NA) +
geom_jitter(width = .05, alpha = .7) +
geom_line(aes(group = subject), linetype = 'dashed', alpha = .7) +
facet_wrap(~delay) +
ylim(0,1) +
labs(
x = 'Framing',
y = 'Proportion Selection of Safe Option'
) +
theme_bw() +
theme(strip.background = element_rect(color = 'black', fill = 'white'),
axis.ticks = element_blank(),
panel.grid = element_blank())
p2
grid.arrange(p1, p2, nrow = 1)
library(ez)
ad <- d %>%
group_by(subject, direction, magnitude, delay) %>%
summarize(ssd_ = mean(ssd))
m1 <- ezANOVA(wid = subject, within = .(direction, magnitude),
between = .(delay), dv = ssd_, detailed = TRUE, data = ad)
cbind(m1$ANOVA, data.frame(n2p = m1$ANOVA$SSn / (m1$ANOVA$SSn + m1$ANOVA$SSd)))
library(lme4)
d$direction_e <- ifelse(d$direction == 'Easier than Reference', -0.5, 0.5)
d$delay_e <- ifelse(d$delay == 'Controlled', 0.5, -0.5)
d$delay_e <- ifelse(d$delay == 'Enforced', 0.5, -0.5)
mm1 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e * delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
mm1 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e * delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
mm1a <- glmer(ssd ~ direction_e * delay_e +
(1 | subject) +
(0 + direction_e + delay_e + direction_e:delay_e| subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1, mm1a)
mm1b <- glmer(ssd ~ direction_e * delay_e +
(1 | subject) +
(0 + direction_e + delay_e | subject) +
(0 + direction_e:delay_e | subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1b, mm1a)
mm2 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e + delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1b, mm2)
## winning model
mm3 <- glmer(ssd ~ direction_e * delay_e + (1 | subject) + (0 + direction_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm3, mm2)
mm4 <- glmer(ssd ~ direction_e * delay_e + (1 | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm3, mm4)
head(d)
d[d$delay=='Enforced',]
head(d[d$delay=='Enforced',])
summary(factor(d$direction_e))
summary(factor(d$direction))
d$direction_e <- ifelse(d$direction == 'Easier', -0.5, 0.5)
d$delay_e <- ifelse(d$delay == 'Enforced', 0.5, -0.5)
mm1 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e * delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
mm1 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e * delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
mm1a <- glmer(ssd ~ direction_e * delay_e +
(1 | subject) +
(0 + direction_e + delay_e + direction_e:delay_e| subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1, mm1a)
mm1b <- glmer(ssd ~ direction_e * delay_e +
(1 | subject) +
(0 + direction_e + delay_e | subject) +
(0 + direction_e:delay_e | subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1b, mm1a)
mm2 <- glmer(ssd ~ direction_e * delay_e + (1 + direction_e + delay_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm1b, mm2)
## winning model
mm3 <- glmer(ssd ~ direction_e * delay_e + (1 | subject) + (0 + direction_e | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm3, mm2)
mm4 <- glmer(ssd ~ direction_e * delay_e + (1 | subject), data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm3, mm4)
mm <- mm3
## hypothesis testing
mm2 <- glmer(ssd ~ delay_e + delay_e:direction_e  +
(1 | subject) +
(0 + direction_e | subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm, mm2)
summary(mm)
exp(fixef(mm))
exp(confint(mm, method = 'Wald'))
anova(mm, mm2)
mm2 <- glmer(ssd ~ direction_e + delay_e:direction_e  +
(1 | subject) +
(0 + direction_e | subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm, mm2)
## interaction
mm2 <- glmer(ssd ~ direction_e + delay_e  +
(1 | subject) +
(0 + direction_e | subject),
data = d, family = binomial(link = 'logit'), nAGQ = 1)
anova(mm, mm2)
q()
