---
title: 'Experiment 2 Theory'
author: 'Dave Braun'
date: December 23, 2022
output:
    md_document:
        variant: markdown_github
        toc: TRUE
        df_print: 'paged'
        standalone: TRUE
knit: (function(input, encoding, output) {knitr::knit(input=input, encoding = encoding, output='../md/experiment-2-theory.md')})
---

# Experiment 2 Theory

In this document I will be putting together an absolutely beautiful summary of the theory behind Experiment 2. This theory relies both on [[measurement.md]] and [[stimuli.md]].

```{r include = FALSE, setup}
## super useful docs on knitr
## https://yihui.org/knitr/options/#chunk_options

library(tidyverse)
library(latex2exp)
knitr::opts_knit$set(base.dir = '/home/dave/Dropbox (Lehigh University)/post_doc/professional/projects/gaita/ideation/structured/md/')
knitr::opts_chunk$set(fig.path = 'figures/', fig.align = 'center',
                      fig.width = 12, fig.height = 10,
                      out.width = '50%', out.height = '30%',
                      echo = FALSE)
```

## Prospect theory

The form of prospect theory is:

$$
V = \pi(p) \cdot v(x)
$$
### Probability weighting function

Let's look more closely at the probability weighting function:

$$
\pi(p) = \frac{p^{\gamma}}{(p^{\gamma} + (1 - p)^{\gamma})^{1/\gamma}}
$$

Let's look at this function over various parameter level specifications:


```{r echo = FALSE}
w <- function(p, gam) {
    numerator <- p^gam
    denominator <- (p^gam + (1 - p)^gam)^(1/gam)
    return(numerator / denominator)
}

d <- expand.grid(p = seq(0, 1, by = .001), gam = seq(.4, .7, by = .1))
d$sp <- w(d$p, d$gam)

d %>% 
    ggplot(aes(x = p, y = sp)) + 
    geom_abline(intercept = 0, slope = 1, linetype = 'dotted') + 
    geom_line(aes(linetype = factor(gam))) + 
    labs(
        x = 'Objective Probability',
        y = 'Subjective Probability',
        linetype = TeX(r"($\gamma$)")
    ) + 
    theme_bw() + 
    theme(axis.ticks = element_blank(),
          panel.grid = element_blank())

```


This is truly profound.


### Value function

The functional form of the value function is:


$$
v(x) = \begin{cases}
    x^{\alpha} & \text{if } x \geq 0 \\
    -\lambda \cdot (-x)^{\alpha} & \text{if } x < 0
    \end{cases}
$$



Plot with $\lambda = 2$ and $\alpha = .65$:

```{r}
d <- data.frame(x = seq(-1, 1, by = .001))
v <- function(x, alpha = .65, lambda = 2) {
   if (x >= 0) {
       return(x^alpha)
   } 
    return(-lambda * (-x)^alpha)
}

d$sv <- sapply(d$x, v)

d %>% 
    ggplot(aes(x = x, y = sv)) +
    geom_hline(yintercept = 0) + 
    geom_vline(xintercept = 0) + 
    annotate('text', label = 'Losses', x = -.8, y = .2) + 
    annotate('text', label = 'Gains', x = .8, y = .2) + 
    ylim(-2,2) +
    geom_line(size = 2) + 
    labs(
        x = 'Outcome',
        y = TeX(r'($v(x)$)')
    ) + 
    theme_bw() +
    theme(axis.ticks = element_blank(),
          axis.text = element_blank())
    

```

This is truly remarkable.

**Testing more piecewise functions**

Absolute value:

$$
\lvert x \rvert = \begin{cases}
    x & \text{if } x \geq 0 \\ 
    -x & \text{if } x < 0
    \end{cases}
$$

Sign function:

$$
\text{sgn }x = \begin{cases}
1 & \text{if } x > 0 \\
0 & \text{if } x = 0 \\
-1 & \text{if } x < 0
\end{cases}
$$


Testing aligned functions

$$
\begin{align}
f(x) = x^2 \\
g(x) = ln(x) \\
k(x) = e^x
\end{align}
$$















